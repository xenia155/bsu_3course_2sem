<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="Submission" content="CF8K1QOFVX2Z0U3FIAFS3KD51"/>
<meta name="Time" content="2024-03-28T10:52:48Z"/>
<meta name="ID" content="DataSet"/>
<meta name="User" content="vyto-baby-vodo-rena"/>
<meta name="Problem" content="wiley/codecheck-bj-4-concur-103"/>
<meta name="Elapsed" content="3336 ms"/>
<style type="text/css">
.header {font-weight: bold; font-size: 1.2em; }
.item {font-weight: bold;}
.pass {color: green;}
.fail {color: red;}
.note {color: blue; font-weight: bold;}
table.file td {padding-right: 1em; background: #FFF; }
.linenumber {color: gray;}
.footnote {font-size: 0.7em;}
table {font-size: 0.9em;}
td, th { background: #EEE; margin: 0.5em; padding: 0.25em;}
table.output td {vertical-align: top;}
div.footnotes { border-top: 1px solid gray; padding-top: 0.5em; }
</style>
<title>Report</title>
</head>
<body>
<p class="header run">Running DataSet.java</p>
<div class="run">
<pre class="output">9999999.0
</pre>
<span class="pass">pass </span></div>
<p class="header studentFiles">Submitted files</p>
<div class="studentFiles">
<p class="caption">DataSet.java:</p>
<pre class="output">import java.util.concurrent.locks.Condition;
import java.util.concurrent.locks.Lock;
import java.util.concurrent.locks.ReentrantLock;

public class DataSet
{
   /**
      Constructs an empty data set.
   */
   public DataSet(double[] values)
   {
      this.values = values;
      max = 0;      
      myLock = new ReentrantLock();
      completionCondition = myLock.newCondition();      
   }

   /**
      Gets the maximum of the added data.
      @return the average or 0 if no data has been added
   */
   public double getMaximum() 
   {
      if (values.length == 0) return 0;

      max = values[0];      
      final int THREADS = 10;      
      int size = values.length / THREADS;
      completionCount = 0; // Initialize completionCount
      
      for (int i = 0; i &lt; THREADS; i++)
      {
         Runnable r = new RangeProcessor(i * size, (i + 1) * size);
         Thread t = new Thread(r);
         t.start();
      }

      myLock.lock(); // Acquire the lock
      try
      {
         while (completionCount &lt; THREADS) // Check if completion count has reached the total number of threads
         {
            try
            {
               completionCondition.await(); // Wait until completion count changes
            }
            catch (InterruptedException e)
            {
               return 0; // Return 0 if InterruptedException occurs
            }
         }
      }
      finally
      {
         myLock.unlock(); // Release the lock
      }

      return max;
   }

   private class RangeProcessor implements Runnable
   {
      public RangeProcessor(int start, int end)
      {
         this.start = start;
         this.end = Math.min(end, values.length);
      }
      
      public void run()
      {
         double rangeMax = values[start];
         for (int i = start + 1; i &lt; end; i++)
            rangeMax = Math.max(rangeMax, values[i]);
         myLock.lock();
         try
         {
            max = Math.max(max, rangeMax);
            completionCount++;
            completionCondition.signal(); // Signal that the completion count has changed
         }
         finally
         {
            myLock.unlock();
         }
      }
      
      private int start;
      private int end;
   }
   
   private double[] values;

   private double max;
   private int completionCount;
   private Lock myLock;
   private Condition completionCondition;
   
   // this method is used to check your work
   
   public static void main(String[] args)  
   {
      final int SIZE = 10000000;
      double[] v = new double[SIZE];
      int shift = (int) (Math.random() * SIZE);
      for (int i = 0; i &lt; SIZE; i++) v[(i + shift) % SIZE] = i;
      DataSet data = new DataSet(v);
      double max = data.getMaximum();
      System.out.println(max);
   }
}
</pre>
</div>
<p class="header score">Score</p>
<div class="score">
<p class="score">1/1</p>
</div>
<div class="footnotes"><div class="footnote">2024-03-28T10:52:48Z</div>
</div>
</body></html>
